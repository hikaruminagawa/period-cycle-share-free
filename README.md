# NaoApp – 生理周期トラッカー (PWA)

フロントエンドのみで完結するモバイル優先のPWA。IndexedDB に保存し、共有リンクは URL フラグメントに gzip+base64url で安全に埋め込みます。サーバー・外部DBは不要です。

## 技術
- Next.js 15 (App Router) + TypeScript
- Tailwind CSS
- IndexedDB(idb-keyval) + localStorage
- PWA: manifest.json + Service Worker
- テスト: Vitest + @testing-library/react

## セットアップ
1) 依存をインストール

```bash
pnpm install
```

2) 開発サーバー

```bash
pnpm dev
```

3) ビルド & PWA 確認

```bash
pnpm build
pnpm preview
```

## 目的と機能
- 生理開始日の記録と周期推定（簡易）
- カレンダー表示（生理/排卵/受精可能性/次回予測）
- 症状・メモの当日入力（1タップ）
- 共有リンク（/share#payload）で閲覧専用表示
- PWA・オフライン対応
- 設定：言語切替、排卵日調整、JSONエクスポート/インポート

## 受け入れ基準チェックリスト
1) 生理開始日の記録
- [ ] 初回起動→ start_date 保存→ Home/Calendar 反映
2) 予測
- [ ] 過去3件入力→ Home に次回/排卵/ウィンドウ
3) 症状1タップ入力
- [ ] Log で1タップ→ 当日記録保存
4) 共有リンク生成
- [ ] Share で「共有リンクを作成」→ /share#... をコピー
5) 閲覧専用表示
- [ ] 共有URLを別ブラウザで開く→ 復号成功→ 編集不可UI
6) PWA・オフライン
- [ ] ホーム追加→ 機内モード起動→ 入力/閲覧可能
7) JSONエクスポート/インポート
- [ ] Settings でエクスポートDL/インポート→ 画面反映

## 起動手順と確認ポイント

### 開発環境での確認
1. **開発サーバー起動**
   ```bash
   npm run dev
   # http://localhost:3000 でアクセス (ポートが使用中の場合は npm run dev -- -p 3001)
   ```

2. **基本機能確認**
   - ホーム画面で生理開始日を入力 → 予測が表示される
   - ログページで1タップ入力 → 当日データが保存される
   - カレンダーページで色分け表示確認
   - 設定ページで言語切替・エクスポート/インポート動作

3. **共有機能確認**
   - 共有ページで「共有リンクを作成」→ URL生成
   - 生成されたURLを新しいタブで開く → 閲覧専用表示

### PWA確認
1. **ビルド & プレビュー**
   ```bash
   npm run build
   npm run preview
   ```

2. **PWA機能確認**
   - ブラウザのアドレスバーに「インストール」アイコン表示
   - スマートフォンで「ホーム画面に追加」可能
   - オフライン状態での基本機能動作

### テスト実行
```bash
npm test
```

## 注意
- 本アプリの予測は医療目的ではありません。体調に不安がある場合は医療機関に相談してください。
- 共有リンクはURLを知っている人全員が閲覧できます。個人情報は含めないでください。

## フォルダ
- `app/*` ルート/ページ
- `components/*` UI
- `lib/*` 予測/共有/保存
- `public/*` PWA 画像・manifest
- `tests/*` 単体テスト
